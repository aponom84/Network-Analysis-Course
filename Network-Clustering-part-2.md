# **Кластеризация в сетях — Часть 2 – поиск пересекающихся сообществ**

## 1. Постановка задачи поиска пересекающихся сообществ

**Формальная постановка:**

Пусть $G = (V, E)$ - граф с $n$ узлами $V = \{v_1, v_2, ..., v_n\}$ и $m$ ребрами $E \subseteq V \times V$.

Задача обнаружения пересекающихся сообществ может быть определена через матрицу принадлежности $F$, где $F_{vc}$ обозначает степень принадлежности узла $v$ сообществу $c$.

- Для пересекающихся сообществ: $0 \leq F_{vc} \leq 1, \forall v \in V, \forall c \in C$
- Для непересекающихся сообществ: $F_{vc} \in \{0, 1\}$

**Особенности пересекающихся сообществ:**
- Узел может принадлежать одновременно нескольким сообществам
- Степень принадлежности может быть непрерывной величиной (soft clustering)
- Более реалистично отражает структуру многих реальных сетей (социальные сети, биологические сети и др.)

## 2. Подход Link Partitioning

**Основная идея:**
- Вместо разделения узлов на сообщества, разделяем множество ребер
- Сообщества определяются через отношения между узлами, а не через сами узлы
- Узел принадлежит сообществу, если он имеет смежные ребра, принадлежащие этому сообществу

**Иллюстративный пример:**
Человек может играть в футбол с друзьями по выходным и работать с коллегами по будням. При этом некоторые коллеги могут быть его друзьями. Таким образом, человек имеет два типа отношений: "играет в футбол с" и "работает с", и принадлежит двум сообществам: "футбольные игроки" и "коллеги".

**Математическая реализация:**
1. Строится линейный граф $L(G)$, где:
   - Вершины $L(G)$ соответствуют ребрам исходного графа $G$
   - Две вершины в $L(G)$ соединены ребром, если соответствующие ребра в $G$ имеют общую вершину

2. Выполняется разделение вершин линейного графа на непересекающиеся сообщества

3. Вершина исходного графа принадлежит сообществу, если инцидентные ей ребра принадлежат этому сообществу в линейном графе

**История развития:**
- Evans и Lambiotte (2009-2010) первыми применили разделение узлов линейного графа для получения разделения ребер исходного графа
- Kim и Jeong (2011) предложили модифицированную версию метода Infomap для обнаружения link communities
- Evans (2010) расширил подход линейного графа на кликовые графы

## 3. Метод LPAM (Link Partitioning Around Medoids)

**Основная идея метода:**
Метод LPAM объединяет подход link partitioning с алгоритмом Partitioning Around Medoids (PAM) для обнаружения пересекающихся сообществ в сетях с заданным количеством кластеров.

**Этапы алгоритма LPAM:**

1. **Построение линейного графа:**
   - Создается линейный граф $L(G)$ исходного графа $G$
   - Вершины $L(G)$ соответствуют ребрам $G$
   - Ребра в $L(G)$ соединяют вершины, соответствующие смежным ребрам в $G$

2. **Обнаружение непересекающихся сообществ в линейном графе:**
   - Вычисляется матрица расстояний $D = (d_{ij}) \in \mathbb{R}^{m \times m}$ для вершин $L(G)$
   - В работе используются два типа функций расстояния:
     * **Commute distance** - время, необходимое случайной прогулке, чтобы дойти от узла $i$ до узла $j$ и вернуться обратно
     * **Amplified commute distance** - модификация commute distance, дающая более точные результаты
   
   - Применяется алгоритм Partitioning Around Medoids (PAM) для получения $k$ кластеров

3. **Преобразование кластеров ребер в кластеры узлов:**
   - Узел $v$ принадлежит сообществу $c$ с коэффициентом $F_{vc}$, пропорциональным количеству смежных ребер, принадлежащих кластеру $c$
   - Параметр $\theta$ контролирует степень пересечения сообществ: с увеличением $\theta$ возрастает степень пересечения

**Вычислительная сложность:**
- Точная версия: экспоненциальная сложность $O(2^{|E|})$, так как задача k-median является NP-полной
- Эвристическая версия: использует метод CLARANS с теоретической сложностью, близкой к квадратичной

**Преимущества метода LPAM:**
- Естественным образом порождает пересекающиеся сообщества
- Может работать с заданным количеством кластеров
- Использует более информативные метрики расстояния (commute distance и его усиленную версию)
- Экспериментальные результаты показывают конкурентоспособность с существующими методами

**Визуальное представление:**
На рисунке 1 статьи показан пример 8×8 решетки и соответствующего линейного графа. Кластеры выделены цветными прямоугольниками, медоиды на линейном графе представлены большими кругами, а в исходном графе медоиды обозначены жирными ребрами.

**Экспериментальные результаты:**
- Метод был протестирован на реальных сетях и синтетических бенчмарках
- Для небольших и средних сетей был найден точный результат
- Для крупных сетей использовалась эвристическая версия LPAM
- Результаты показали, что эвристическая версия дает решения, близкие к точным
- Метод конкурентоспособен с существующими подходами по метрикам F1, ONMI и другим

**Заключение:**
Метод LPAM представляет собой эффективный подход к обнаружению пересекающихся сообществ, основанный на комбинации link partitioning и алгоритма Partitioning Around Medoids. Он преобразует задачу поиска пересекающихся сообществ в задачу поиска непересекающихся сообществ в линейном графе, что позволяет использовать хорошо изученные методы для непересекающихся кластеров и естественным образом получать пересекающиеся сообщества в исходной сети.


